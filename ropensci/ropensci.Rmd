---
title: "| rOpenSci: cómo acceder de forma reproducible a repositorios de datos públicos \n"
  
author: Ignasi Bartomeus^1^
  
output:
  word_document:
    fig_caption: yes
    fig_height: 6
    fig_width: 7.5
    highlight: null
    reference_docx: Ecosistemas_template.docx
    
csl: ecosistemas.csl
bibliography: 
  - references.bib
  - knitcitations.bib
---


> (1) Departmento de Ecología Integrativa, Estación Biológica de Doñana, Consejo Superior de Investigaciones Científicas, Avda. Américo Vespucio 26, 41092 Sevilla, España.

> Autor para correspondencia: Ignasi Bartomeus [nacho.bartomeus@gmail.com]


```{r knitcitations, echo=FALSE, cache = FALSE}
library(knitcitations)
cleanbib()   
cite_options(citation_format = "pandoc")
```

El uso de datos públicos ha abierto la puerta a responder un abanico de preguntas que antes era inimaginable. En ecología hay repositorios de datos de ocurrencia de especies (www.gbif.com), climáticos (www.worldclim.com) o filogenéticos (www.treebase.com) que por si solos o combinados permiten análisis para testar teorías generales a una escala global. Sin embargo, obtener estos datos suele hacerse de forma no reproducible mediante el uso de interficies web. Estas interficies son útiles para explorar los datos y te permiten seleccionar que tipo de datos quieres y descargarlos a tu ordenador, pero en este proceso es suboptimo por dos razones. Primero, una vez tienes los datos, es imposible recordar que selección hizistes exactamente (no hay trazabilidad). Segundo, cuando hay nuevos datos disponibles o se han corregido errores en los datos originales del repositorio es imposible actualizar tus datos de forma automática. 

El equipo de ropensci (https://ropensci.org), entre otras cosas, se dedica a crear paquetes de R que permiten el acceso a datos públicos desde tu terminal de R. Esto te permite tener un código que es legible tanto por maquinas, como por humanos que especifica exactamente que datos has descargado (hay una trazabilidad completa). Asimismo, actualizar los datos con los últimos cambios no requiere más esfuerzo que volver a correr el código. Las ventajas no son solo en incrementar la reproducibilidad de tus resultados, sino sobretodo te permite ahorrar tiempo y reducir el numero de pasos de tu flujo de trabajo, y por siguiente el numero de potenciales errores de bulto que se pueden cometer en cada paso.

Un ejemplo de este tipo de paquetes es bajar datos de tu especie favorita de gbif usando el paquete `rGbif`. Vamos a verlo en tres simples pasos que apenas ocupan cuatro lineas de código en R.

1) Instalar y cargar el paquete
```{r results='hide', echo = TRUE, message=FALSE, warning=FALSE}
#install.packages("rgbif") #solo has de instalarlo la primera vez
library(rgbif)
```

2) Bajar los datos que queremos
```{r}
dat <- occ_search(scientificName = "Andrena flavipes", limit = 10000)
#dat
```


3) Mostrar gráficamente los datos obtenidos.

```{r message=FALSE, fig.height=2, fig.width=2}
library(maps)
map("world", fill=TRUE, col="white", bg="lightblue", ylim=c(30, 70), xlim = c(-30,30), mar=c(0,0,0,0))
points(dat$data$decimalLongitude, dat$data$decimalLatitude, col="red", pch=16)
```

En este ejemplo muy simple nos limitamos a representar datos gráficamente, pero se pueden hacer análisis más interesantes combinando datos de varias fuentes (e.j.. https://ropensci.org/usecases/). 

La lista de paquetes disponibles para acceder a datos crece año a año (https://ropensci.org/packages/#data_access) y los paquetes se actualizan con regularidad solucionando errores o introduciendo mejoras, por tanto si encuentras algún fallo lo mejor que puedes hacer es comentárselo a sus autores. 

Si estas interesado en el uso de datos libres y quieres hacerlo de forma programática, ropensci es un buen inicio, pero hay otros paquetes para R disponibles en CRAN, y para los que no usan R a veces existen clientes específicos para otros lenguajes (e.j. python). Solo es cuestión de saber buscar la herramienta que necesitas.

